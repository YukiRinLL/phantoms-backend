# 应用基础配置
app:
  version: 1.0.0

server:
  port: 8080

# log4j2
logging:
  file:
    name: logs/phantoms-backend.log
  level:
    # 全局日志级别
    root: info
    # 框架日志级别
    org.springframework: INFO
    org.springframework.web.socket: INFO
    org.springframework.messaging: INFO
    org.springframework.data.redis: WARN
    # 业务包日志级别
    com.phantoms.phantomsbackend: DEBUG
    # 数据库日志
    org.springframework.jdbc.core.JdbcTemplate: WARN
    org.hibernate.SQL: WARN
    org.hibernate.type.descriptor.sql.BasicBinder: WARN
    org.postgresql: WARN
    com.zaxxer.hikari: WARN
    # 其他框架日志
    springfox: WARN

spring:
  # 应用名称[citation:4]
  application:
    name: phantoms-backend
  # 激活的环境配置文件[citation:1]
  profiles:
    active: dev

  autoconfigure:
    exclude: org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration
  datasource:
    primary:
      # Supabase Transaction Pooler mode
      url: ${SUPABASE_PRIMARY_URL:jdbc:postgresql://aws-0-ap-southeast-1.pooler.supabase.com:6543/postgres}
      username: ${SUPABASE_PRIMARY_USERNAME:postgres.dshmbsawwrbuycnivcjs}
      password: ${SUPABASE_PRIMARY_PASSWORD}
      driver-class-name: org.postgresql.Driver

    secondary:
      url: ${MYSQL_SECONDARY_URL:jdbc:mysql://mysql2.sqlpub.com:3307/phantoms_db?allowPublicKeyRetrieval=true}
      username: ${MYSQL_SECONDARY_USERNAME:yukirinll}
      password: ${MYSQL_SECONDARY_PASSWORD}
      driver-class-name: com.mysql.cj.jdbc.Driver

    hikari:
      idle-timeout: 30000
      max-lifetime: 1800000
      connection-timeout: 30000
      pool-name: SupabasePool
      maximum-pool-size: 20
      minimum-idle: 10
      data-source-properties:
        preparedStatementCacheQueries: 0
        preparedStatementCacheSizeMiB: 0
        prepareThreshold: 0

  jpa:
    properties:
      hibernate:
        temp:
          use_jdbc_metadata_defaults: false
        order_inserts: true
        order_updates: true
        jdbc:
          batch_size: 50
          lob:
            non_contextual_creation: true
        bytecode:
          provider: bytebuddy
        format_sql: true
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: validate
    show-sql: false

  # E-mail (QQ 邮箱配置)
  mail:
    host: smtp.qq.com
    port: 465
    username: ${EMAIL_USERNAME:3146672611@qq.com}
    password: ${EMAIL_PASSWORD}
    from:
      name: Phantoms Official
    properties:
      mail:
        smtp:
          ssl:
            enable: true
          auth: true

  data:
    # Redis
    redis:
      url: ${REDIS_URL:rediss://red-d03imhre5dus73ab817g:OXtvQrLbJ1WXXdjXMEVknm1hPnW8XFAo@oregon-keyvalue.render.com:6379}
      timeout: 10000
      connect-timeout: 5000
      lettuce:
        pool:
          max-active: 20
          max-idle: 10
          min-idle: 5
          max-wait: 3000ms
        shutdown-timeout: 100ms


# 房屋销售监控配置
housing:
  sale:
    notify:
      servers: "1121,1081"  # 要监控的服务器列表 1121拂晓之间 1018神意之地
      areas: "0,1,2,3,4"    # 要监控的区域：0-海雾村,1-薰衣草苗圃,2-高脚孤丘,3-白银乡,4-穹顶皓天

mybatis-plus:
  global-config:
    db-config:
      field-strategy: not_null
      id-type: assign_uuid
  configuration:
    map-underscore-to-camel-case: true

# swagger
springdoc:
  api-docs:
    enabled: true
  swagger-ui:
    enabled: true
    path: /swagger-ui.html

# Spring Boot Actuator
management:
  endpoints:
    web:
      exposure:
        include: "*"
  metrics:
    enable:
      jdbc: true

#Napcat QQ
shiro:
  ws:
    server:
      enable: true
      url: "/shiro/ws"

#NapCatQQUtil
napcat:
  http-server-url: ${NAPCAT_HTTP_SERVER_URL:https://jxvidlueiljp.us-west-1.clawcloudrun.com}
  access-token: ${NAPCAT_ACCESS_TOKEN:7saligia}
  default-group-id: ${NAPCAT_DEFAULT_GROUP_ID:595883141}
  phantom-group-id: ${NAPCAT_PHANTOM_GROUP_ID:787909466}
  admin-qq: "944989026"

# DaoYu Key监控配置
monitor:
  check:
    enabled: true
  notification:
    email: 944989026@qq.com  # 通知邮箱
    notify-on-success: true  # 成功时也发送通知

xivapi:
  base-url: "https://v2.xivapi.com/api"

leancloud:
  app-id: ${LEANCLOUD_APP_ID:4NeSS81j4KK0uyYULpfk52yh-gzGzoHsz}
  app-key: ${LEANCLOUD_APP_KEY}
  server-url: ${LEANCLOUD_SERVER_URL:https://4ness81j.lc-cn-n1-shared.com}
  log-level: "DEBUG"

d1:
  api-url: https://api.cloudflare.com
  account-id: ${CLOUDFLARE_ACCOUNT_ID:0e7f3f296b75e9770c65d0d0fa73d7d7}
  database-id: ${CLOUDFLARE_DATABASE_ID:0ad9906c-ec63-4111-b741-647627eee096}
  api-token: ${CLOUDFLARE_API_TOKEN}
  log-level: WARNING

scrapestack:
  access-key: ${SCRAPESTACK_ACCESS_KEY}